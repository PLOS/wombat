<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
  <front>
    <journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
        <publisher-name>Public Library of Science</publisher-name>
        <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher></journal-meta>
    <article-meta><article-id pub-id-type="publisher-id">PCOMPBIOL-D-11-01289</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1002430</article-id><article-categories>
        <subj-group subj-group-type="heading">
          <subject>Research Article</subject>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Biology</subject>
          <subj-group>
            <subject>Computational biology</subject>
          </subj-group>
          <subj-group>
            <subject>Evolutionary biology</subject>
            <subj-group>
              <subject>Evolutionary processes</subject>
            </subj-group>
            <subj-group>
              <subject>Forms of evolution</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Theoretical biology</subject>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline">
          <subject>Computational Biology</subject>
          <subject>Evolutionary Biology</subject>
        </subj-group>
      </article-categories><title-group><article-title>Implications of Behavioral Architecture for the Evolution of Self-Organized Division of Labor</article-title><alt-title alt-title-type="running-head">Behavioral Architectures for Division of Labor</alt-title></title-group><contrib-group>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Duarte</surname>
            <given-names>A.</given-names>
          </name>
          <xref ref-type="aff" rid="aff1"/>
          <xref ref-type="fn" rid="fn1">
            <sup>¤</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Scholtens</surname>
            <given-names>E.</given-names>
          </name>
          <xref ref-type="aff" rid="aff1"/>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Weissing</surname>
            <given-names>F. J.</given-names>
          </name>
          <xref ref-type="aff" rid="aff1"/>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
      </contrib-group><aff id="aff1">          <addr-line>Theoretical Biology, Centre for Ecological and Evolutionary Studies, University of Groningen, Groningen, The Netherlands</addr-line>       </aff><contrib-group>
        <contrib contrib-type="editor" xlink:type="simple">
          <name name-style="western">
            <surname>Sporns</surname>
            <given-names>Olaf</given-names>
          </name>
          <role>Editor</role>
          <xref ref-type="aff" rid="edit1"/>
        </contrib>
      </contrib-group><aff id="edit1">Indiana University, United States of America</aff><author-notes>
        <corresp id="cor1">* E-mail: <email xlink:type="simple">f.j.weissing@rug.nl</email></corresp>
        <fn fn-type="current-aff" id="fn1">
          <label>¤</label>
          <p>Current address: Department of Zoology, University of Cambridge, Cambridge, United Kingdom</p>
        </fn>
        <fn fn-type="con">
          <p>Conceived and designed the experiments: AD FJW. Performed the experiments: AD ES. Analyzed the data: AD. Wrote the paper: AD FJW.</p>
        </fn>
      <fn fn-type="conflict">
        <p>The authors have declared that no competing interests exist.</p>
      </fn></author-notes><pub-date pub-type="collection">
        <month>3</month>
        <year>2012</year>
      </pub-date><pub-date pub-type="epub">
        <day>22</day>
        <month>3</month>
        <year>2012</year>
      </pub-date><volume>8</volume><issue>3</issue><elocation-id>e1002430</elocation-id><history>
        <date date-type="received">
          <day>30</day>
          <month>8</month>
          <year>2011</year>
        </date>
        <date date-type="accepted">
          <day>1</day>
          <month>2</month>
          <year>2012</year>
        </date>
      </history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2012</copyright-year><copyright-holder>Duarte et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
        <p>Division of labor has been studied separately from a proximate self-organization and an ultimate evolutionary perspective. We aim to bring together these two perspectives. So far this has been done by choosing a behavioral mechanism <italic>a priori</italic> and considering the evolution of the properties of this mechanism. Here we use artificial neural networks to allow for a more open architecture. We study whether emergent division of labor can evolve in two different network architectures; a simple feedforward network, and a more complex network that includes the possibility of self-feedback from previous experiences. We focus on two aspects of division of labor; worker specialization and the ratio of work performed for each task. Colony fitness is maximized by both reducing idleness and achieving a predefined optimal work ratio. Our results indicate that architectural constraints play an important role for the outcome of evolution. With the simplest network, only genetically determined specialization is possible. This imposes several limitations on worker specialization. Moreover, in order to minimize idleness, networks evolve a biased work ratio, even when an unbiased work ratio would be optimal. By adding self-feedback to the network we increase the network's flexibility and worker specialization evolves under a wider parameter range. Optimal work ratios are more easily achieved with the self-feedback network, but still provide a challenge when combined with worker specialization.</p>
      </abstract><abstract abstract-type="summary">
        <title>Author Summary</title>
        <p>In insect colonies, different individuals specialize in different tasks related to colony maintenance and growth. Unveiling why this division of labor evolved and how individuals decide which task to take on is crucial for our understanding of complex group behavior. Here we model the evolution of general behavioral rules for processing environmental signals of task need in social insect colonies, using artificial neural networks. We examine the patterns of individual specialization that arise in the course of evolution. Division of labor is likely to evolve if switching between tasks decreases worker productivity, but the pattern of division of labor across colonies is highly dependent on the architecture of the networks considered. In networks that allow for a feedback of previous experience on future task choice, division of labor can evolve across the whole population of colonies. In networks where this feedback is not allowed, the presence of division of labor is constrained by the specific genetic composition of colonies. Network architecture also affects how fine-tuned the worker allocation to different tasks can be when the tasks have different requirements.</p>
      </abstract><funding-group><funding-statement>A. Duarte was supported by a Ubbo Emmius PhD scholarship, attributed by the Centre for Ecological and Evolutionary Studies, University of Groningen. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts>
        <page-count count="15"/>
      </counts></article-meta>
  </front>
  <body>
    <sec id="s1">
      <title>Introduction</title>
      <p>Division of labor is ubiquitous in nature. The major evolutionary transitions, such as the separation of germ and soma and the transition from prokaryotes to eukaryotes, were accompanied by an increase in division of labor <xref ref-type="bibr" rid="pcbi.1002430-Szathmry1">[1]</xref>. The transition from solitary to eusocial in insects encompasses the evolution of a reproductive caste and a sterile worker caste. Furthermore, division of labor among sterile workers also evolved, in which different groups of workers specialize in different functions, such as foraging and brood care <xref ref-type="bibr" rid="pcbi.1002430-Oster1">[2]</xref>. Colony growth and survival is strongly dependent on the coordinated interaction of a large number of workers. This non-reproductive division of labor is therefore often considered a major determinant of the ecological success of eusocial insects and will be the focus of the work presented here.</p>
      <p>Empirical evidence suggests that eusociality has evolved in associations of close kin <xref ref-type="bibr" rid="pcbi.1002430-Boomsma1">[3]</xref>, <xref ref-type="bibr" rid="pcbi.1002430-Boomsma2">[4]</xref>. Variation in behavioral tendencies can be found in forced associations of non-social individuals, leading to incipient forms of division of labor <xref ref-type="bibr" rid="pcbi.1002430-Fewell1">[5]</xref>, <xref ref-type="bibr" rid="pcbi.1002430-Jeanson1">[6]</xref>. Undoubtedly, a source of variation is key to generating consistent inter-individual differences and task specialization <xref ref-type="bibr" rid="pcbi.1002430-Duarte1">[7]</xref>. The questions that arise are how and why such variation arises among close kin. Here we explore some of the mechanisms and conditions through which task specialization can evolve in groups of related individuals.</p>
      <p>Recent work on division of labor in insect societies has focused on the self-organization properties of colony behavior. According to a variety of models <xref ref-type="bibr" rid="pcbi.1002430-Bonabeau1">[8]</xref>–<xref ref-type="bibr" rid="pcbi.1002430-Johnson1">[12]</xref> colony properties emerge from the behavior of individual workers whose reactions to the environment is governed by simple rules. The behavioral rules leading to emergent specialization are probably shaped by natural selection <xref ref-type="bibr" rid="pcbi.1002430-Page1">[10]</xref>, <xref ref-type="bibr" rid="pcbi.1002430-Bonabeau2">[13]</xref>, yet only few studies have focused on the evolution of these rules <xref ref-type="bibr" rid="pcbi.1002430-Tarapore1">[14]</xref>, <xref ref-type="bibr" rid="pcbi.1002430-Waibel1">[15]</xref>. Previous work focusing on the benefits of task specialization in other systems (e.g. enzyme-substrate specialization, coordination in co-viruses) generally disregard the mechanisms underlying it, viewing instead specialists and generalists as fixed behavioral strategies <xref ref-type="bibr" rid="pcbi.1002430-Tannenbaum1">[16]</xref>, <xref ref-type="bibr" rid="pcbi.1002430-Wahl1">[17]</xref>. It is thus important to develop models that integrate the evolutionary and self-organization perspective, in order to create a better understanding of division of labor and its evolution <xref ref-type="bibr" rid="pcbi.1002430-Duarte1">[7]</xref>.</p>
      <p>In previous work, we took the response threshold model <xref ref-type="bibr" rid="pcbi.1002430-Szathmry1">[1]</xref> as a starting point for an evolutionary model for division of labor (A. Duarte, I. Pen, L. Keller and F.J. Weissing, submitted). In the response threshold model, individuals compare an environmental stimulus for a task with their response thresholds; they perform the task if the stimulus is above their threshold, otherwise they remain idle. Using this predefined behavioral architecture, we allowed the evolution of threshold values and showed that division of labor can evolve from a homogeneous population via evolutionary branching, but only if there are clear fitness benefits of individual specialization. Our work also revealed that the response threshold model has the drawback that it imposes severe constraints on the distribution of workers over tasks.</p>
      <p>Here we look at a more flexible behavioral architecture that is represented by a simple artificial neural network (ANN). ANNs simulate the processing of stimuli by individuals, from stimulus perception by receptor nodes to effector nodes determining the behavioral output <xref ref-type="bibr" rid="pcbi.1002430-Ghirlanda1">[18]</xref>, <xref ref-type="bibr" rid="pcbi.1002430-Haykin1">[19]</xref>. ANNs have been used in evolutionary robotics to understand the evolution of communication and cooperation <xref ref-type="bibr" rid="pcbi.1002430-Floreano1">[20]</xref>–<xref ref-type="bibr" rid="pcbi.1002430-Mitri2">[22]</xref>. In a recent paper, Lichocki et al. showed that ANN's, in comparison to response threshold mechanisms, allow for more efficient worker allocation through task switching <xref ref-type="bibr" rid="pcbi.1002430-Lichocki1">[23]</xref>. Here we examine the effect of the architecture of ANN's in worker specialization and worker allocation, in a context where task switching is detrimental.</p>
      <p>In the response threshold model, the response to task-associated stimuli is determined by task-associated thresholds. The stimuli, which reflect the colony's need for work on the various tasks, change dynamically due to two factors: there is an inherent tendency for the stimuli to increase, and they are decreased whenever the corresponding task is performed. We keep most assumptions of the threshold model but allow the task-associated stimuli to be processed by an ANN. In principle both the architecture of the network and the way information is processed could evolve <xref ref-type="bibr" rid="pcbi.1002430-Yao1">[24]</xref>, <xref ref-type="bibr" rid="pcbi.1002430-Fogel1">[25]</xref>, however, we for simplicity, we focus on predefined architectures (with a fixed number of receptor and effector nodes) and allow only for the evolution of connections between the nodes. The stimuli are processed by an ANN consisting of two receptor nodes and two effector nodes (<xref ref-type="fig" rid="pcbi-1002430-g001">Figure 1</xref>). In a second part of our study, we keep the same network structure but allow for the evolution of a feedback from the effector nodes to the processing of the stimuli (<xref ref-type="fig" rid="pcbi-1002430-g001">Figure 1C</xref>). In other words, an effect of previous experience on current decisions can evolve. An effect of previous experience on task preference, leading to division of labor, has been observed in natural colonies <xref ref-type="bibr" rid="pcbi.1002430-Ravary1">[26]</xref>, thus it would be interesting to observe under which circumstances it could evolve.</p>
      <fig id="pcbi-1002430-g001" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pcbi.1002430.g001</object-id>
        <label>Figure 1</label>
        <caption>
          <title>Architecture of the three types of networks.</title>
          <p>Stimulus values are perceived by input neurons. The stimuli are then processed by the network, resulting in an activation energy <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e001" xlink:type="simple"/></inline-formula> for each output neuron. An output neuron is excited whenever the activation energy is larger than the neuron's threshold <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e002" xlink:type="simple"/></inline-formula>. (A) Feedforward neural network, equivalent to the architecture encapsulated in the response threshold model, where only weights <italic>w</italic><sub>11</sub> and <italic>w</italic><sub>22</sub> exist. Hence, the activation energy is equal to the perceived stimulus. (B) Feedforward neural network, fully connected. (C) Recurrent neural network, where self-feedback occurs between activation energies of previous time steps and current activation energies.</p>
        </caption>
        <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002430.g001" xlink:type="simple"/>
      </fig>
      <p>We investigate if these slightly more sophisticated mechanisms for processing input allow for the evolution of adaptive division of labor. More precisely, we study whether task specialization among workers can evolve and moreover, whether an appropriate distribution of workers over tasks can be achieved. Throughout, the main question is whether, and to what extent, the evolution of self-organized division of labor is determined by the underlying architecture of behavior.</p>
    </sec>
    <sec id="s2">
      <title>Model</title>
      <p>The general aspects of the model follow A. Duarte, I. Pen, L. Keller and F.J. Weissing (subm.). We consider a population of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e003" xlink:type="simple"/></inline-formula> colonies, each founded by a single-mated individual that produces <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e004" xlink:type="simple"/></inline-formula> workers (typically <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e005" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e006" xlink:type="simple"/></inline-formula>). Each colony goes through a work phase consisting of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e007" xlink:type="simple"/></inline-formula> time steps (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e008" xlink:type="simple"/></inline-formula>), where all individuals perceive stimuli associated with two tasks and decide whether to perform one of the tasks or remain idle. The amount of work performed and the distribution of workers over tasks determines the fitness of a colony, which corresponds to the number of reproductives produced. Selection occurs because the colonies of a given generation are founded by pairs of reproductives produced in the previous generation. Hence colonies where the workers perform their tasks in the most efficient and coordinated way spread the genes of their foundresses most effectively.</p>
      <p>In line with <xref ref-type="bibr" rid="pcbi.1002430-Bonabeau1">[8]</xref>, we assume that there are two tasks and two task-associated stimuli. Stimuli increase each time step by a fixed amount <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e009" xlink:type="simple"/></inline-formula> and decrease by an amount <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e010" xlink:type="simple"/></inline-formula> whenever a worker performs the task, following <xref ref-type="bibr" rid="pcbi.1002430-Bonabeau1">[8]</xref> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e011" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e012" xlink:type="simple"/></inline-formula> in our simulations). In the response threshold model, the association between stimuli and task was also expressed in the fact that individuals were more likely to perform a task for which the stimulus was high. However, in the present model, this is not necessarily the case. An association between task and stimulus is present because the performance of a given task decreases a given stimulus. Workers are assessed in random order and, once an individual works, the corresponding stimulus value is immediately decreased, such that the next worker to be assessed experiences a different stimulus value.</p>
      <sec id="s2a">
        <title>Artificial neural networks</title>
        <p>The first network studied is a simple feedforward network <xref ref-type="bibr" rid="pcbi.1002430-Haykin1">[19]</xref> that consists of two stimulus input nodes and two behavioral output nodes, all four nodes being connected (<xref ref-type="fig" rid="pcbi-1002430-g001">Figure 1B</xref>). Each input node perceives a task-associated stimulus with a certain error <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e013" xlink:type="simple"/></inline-formula> (drawn from a normal distribution with mean 0 and standard deviation 1). The two signals are then processed and transmitted to the output neurons, via connections with weights <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e014" xlink:type="simple"/></inline-formula> that are evolvable properties of the network. Output nodes receive a weighted sum of the stimuli, generally designated activation energy. The activation energy <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e015" xlink:type="simple"/></inline-formula> of an output node <italic>i</italic> is thus:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e016" xlink:type="simple"/><label>(1)</label></disp-formula>Each output neuron is characterized by a threshold <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e017" xlink:type="simple"/></inline-formula>, which is another evolvable property. If the activation energy of an output neuron exceeds the threshold, the neuron is activated, meaning that an individual is willing to perform the respective task. If both output neurons are activated, one task is chosen at random. Note that the response threshold model implemented in previous work is in fact a special case of the feedforward neural network, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e018" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e019" xlink:type="simple"/></inline-formula> (<xref ref-type="fig" rid="pcbi-1002430-g001">Figure 1A</xref>). The main difference between our feedforward ANN model and the response threshold model is thus the evolution of the connection weights that determine how incoming information is processed and interpreted. The initial values of connection weights in our simulations are: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e020" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e021" xlink:type="simple"/></inline-formula>. Changes in the connection weights and thresholds take place when new individuals are produced, via mutation (see below). During the lifetime of an individual, the parameters of its network are fixed. Thus we do not consider the changing of connection weights with learning, for example.</p>
        <p>The second network architecture studied is a recurrent network <xref ref-type="bibr" rid="pcbi.1002430-Haykin1">[19]</xref>. It includes all previous nodes and connections, and in addition it has two self-feedback loops (<xref ref-type="fig" rid="pcbi-1002430-g001">Figure 1C</xref>). The activation energy in a given time step will affect the activation energy in the next time step: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e022" xlink:type="simple"/></inline-formula>. The connection weight <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e023" xlink:type="simple"/></inline-formula> given to the previous activation energy (from here on called the self-feedback connection) is also an evolvable property that changes through mutation and natural selection during production of new individuals. During the lifetime of individuals, however, there is no change occurring in the parameters of the networks. Self-feedback connection weights were initialized at zero, which is equivalent to the feedforward network, without any influence of past experience in current decisions.</p>
      </sec>
      <sec id="s2b">
        <title>Fitness</title>
        <p>After the work phase, the fitness of each colony is computed based on how much work the workers performed for each task. Fitness is assumed to be proportional to the weighted geometric mean of work done for both tasks:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e024" xlink:type="simple"/><label>(2)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e025" xlink:type="simple"/></inline-formula> is the total number of acts performed for task <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e026" xlink:type="simple"/></inline-formula> (A. Duarte, I. Pen, L. Keller, F.J. Weissing, subm.). We take the geometric rather than the arithmetic mean in order to ensure that fitness can only be achieved if both tasks are being performed. The weighing factor <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e027" xlink:type="simple"/></inline-formula> allows us to consider the (realistic) situation that not all tasks need to be performed equally often. For the fitness function (2), fitness is maximized if idleness is eliminated (<italic>i.e.</italic>, if <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e028" xlink:type="simple"/></inline-formula> is maximal) and if the workers distribute over tasks according to the ratio <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e029" xlink:type="simple"/></inline-formula>. In other words, to maximize fitness the proportion <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e030" xlink:type="simple"/></inline-formula> of work allocated to task 1 by the colony should be equal to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e031" xlink:type="simple"/></inline-formula>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e032" xlink:type="simple"/><label>(3)</label></disp-formula></p>
        <p>Each generation, 2<italic>M</italic> reproductive offspring are produced in total in the population. Colonies contribute to the population's pool of sexual individuals in proportion to their fitness. Population size is thus fixed. The reproductive individuals then form <italic>M</italic> pairs randomly. From each pair one individual will found a new colony with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e033" xlink:type="simple"/></inline-formula> workers, while the old colonies are eliminated.</p>
      </sec>
      <sec id="s2c">
        <title>Genetic details</title>
        <p>We allowed for the evolution of all connection weights and thresholds of output nodes, giving us in a total 6 (resp. 8) evolving traits. These traits are encoded by 6 (resp. 8) gene loci. The alleles at these loci correspond to real numbers, with threshold alleles being larger or equal to zero, while connection weight alleles may also attain negative values. To keep the genetic assumptions as simple as possible, we assume that all individuals are haploid and that the network of each individual is fully determined by its genotype.</p>
        <p>Genotypes of workers and sexuals are similarly inherited: Both types of individuals are offspring of the mated colony foundress, and possess alleles for thresholds and connection weights. Our model allows genetic linkage of the threshold loci or linkage of the connection weight loci, but both types of loci are considered to be sufficiently far apart in the genome to make them segregate independently. The degree of linkage is determined by a parameter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e034" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e035" xlink:type="simple"/></inline-formula>) that corresponds to a recombination rate. With probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e036" xlink:type="simple"/></inline-formula>, the threshold alleles (resp. the connection weight alleles) are inherited as a block from one of the two parents; with probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e037" xlink:type="simple"/></inline-formula>, the parent whose allele is transmitted is chosen independently of what happens at the other loci.</p>
        <p>Mutation occurs with probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e038" xlink:type="simple"/></inline-formula> at each locus; when a mutation occurs, the genetic value at that locus is changed by adding a real number to it that is drawn from a normal distribution with mean 0 and standard deviation <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e039" xlink:type="simple"/></inline-formula>. In our simulations, we typically used <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e040" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e041" xlink:type="simple"/></inline-formula>.</p>
      </sec>
      <sec id="s2d">
        <title>Measuring worker specialization</title>
        <p>We evaluate colony-level characteristics such as the proportion of work devoted to each task and the level of individual specialization. For each individual we calculate at the end of a simulation the fraction <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e042" xlink:type="simple"/></inline-formula> of time steps that it stayed in the same task from that time step to the next. We average <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e043" xlink:type="simple"/></inline-formula> over all workers and normalize this measure by dividing <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e044" xlink:type="simple"/></inline-formula> by the probability that individuals stay in the same task merely due to chance. The latter is given by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e045" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e046" xlink:type="simple"/></inline-formula> is the proportion of work devoted to task <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e047" xlink:type="simple"/></inline-formula>. By subtracting 1 from the value thus obtained, we obtain a measure of worker specialization that ranges between −1 and 1 (A. Duarte, I. Pen, L. Keller and F. J. Weissing, subm.):<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e048" xlink:type="simple"/><label>(4)</label></disp-formula>When <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e049" xlink:type="simple"/></inline-formula> is close to 1, there is a high degree of division of labor, and individuals stay in the same task much more often than expected by chance. If <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e050" xlink:type="simple"/></inline-formula> is close to zero, workers switch between tasks at random. If <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e051" xlink:type="simple"/></inline-formula> is lower than zero, individuals switch task more often than expected by chance.</p>
      </sec>
      <sec id="s2e">
        <title>Switching costs</title>
        <p>Worker specialization can be adaptive if there is a cost to switching tasks (such as a time cost if tasks are confined to different locations, or a cognitive cost), or if specialized workers perform their task with higher efficiency <xref ref-type="bibr" rid="pcbi.1002430-Smith1">[27]</xref>. Here we implemented a time cost scenario, by imposing <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e052" xlink:type="simple"/></inline-formula> time steps of inactivity whenever an individual chooses to switch from one task to the other.</p>
      </sec>
    </sec>
    <sec id="s3">
      <title>Results</title>
      <p>Simulations of the neural network model, with different network architectures were ran for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e053" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e054" xlink:type="simple"/></inline-formula> and switching costs <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e055" xlink:type="simple"/></inline-formula> ranging from 0 to 5 time steps. We also tested the influence of recombination between the loci coding the neural network in the evolution of specialization. There were 10 replicates per parameter combination. The evolutionary patterns of the components of the neural networks were examined (thresholds of output neuron and connection weights) at the population level. Overall, connection weights were far more important than the thresholds in determining the behavior of networks. Hence we do not address here the evolutionary trajectories of threshold loci for the feedforward network. These can be found in the Supplementary Material (<xref ref-type="supplementary-material" rid="pcbi.1002430.s011">Text S1</xref> and <xref ref-type="supplementary-material" rid="pcbi.1002430.s001">Figure S1</xref>).</p>
      <sec id="s3a">
        <title>Feedforward network</title>
        <sec id="s3a1">
          <title>Optimal worker distribution 1∶1</title>
          <p>When <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e056" xlink:type="simple"/></inline-formula>, both tasks are equally needed, and a 1∶1 distribution of workers over tasks would be optimal (see (3)). It is therefore somewhat surprising that, in the absence of switching costs, all replicate populations evolved a work distribution where one of the tasks was performed three times more often than the other (<xref ref-type="fig" rid="pcbi-1002430-g002">Figure 2A</xref>, top panel). From here on we refer to the task performed most often as the “preferred task”. Which task was preferred varied among replicate populations, but within a population all colonies preferred the same task. Variation among colonies in fitness values was small; all colonies reached approximately 94% of the maximum fitness (see <xref ref-type="supplementary-material" rid="pcbi.1002430.s003">Figure S3</xref>). Higher fitness values could not be achieved due to the deviation from a 1∶1 task distribution.</p>
          <fig id="pcbi-1002430-g002" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pcbi.1002430.g002</object-id>
            <label>Figure 2</label>
            <caption>
              <title>Feedforward neural networks: Evolutionary dynamics of two representative simulations, for</title>
              <p><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e057" xlink:type="simple"/></inline-formula>½ <bold>and</bold> <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e058" xlink:type="simple"/></inline-formula><bold>.</bold> Grey scales indicate log counts of colonies with the corresponding value of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e059" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e060" xlink:type="simple"/></inline-formula> (scales on top of the respective graphs) and connection weights (scale on the bottom right-hand side). (A) No switching costs (<italic>c</italic> = 0). Top graphs: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e061" xlink:type="simple"/></inline-formula> decreases to approximately 0.3. Worker specialization remains at zero. Bottom graphs: incoming connection weights at output node 2 evolve to strong positive values, whereas incoming connections weights at output node 1 evolve to weak positive values (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e062" xlink:type="simple"/></inline-formula>) or oscillate around zero (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e063" xlink:type="simple"/></inline-formula>). (B) With switching costs (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e064" xlink:type="simple"/></inline-formula>). Top graphs: the distribution of workers over tasks and the degree of worker specialisation are both highly variable across colonies. At the end of the simulation, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e065" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e066" xlink:type="simple"/></inline-formula> are both bimodally distributed. Bottom graphs: one of the connection weights (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e067" xlink:type="simple"/></inline-formula>) branches, one branch having positive values and the other, negative values. All other connections show weak positive values or remain very close to zero, all being relatively homogeneous in the population.</p>
            </caption>
            <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002430.g002" xlink:type="simple"/>
          </fig>
          <p>Typically in our simulations, both ‘incoming’ connection weights of one of the two output neurons (the neuron corresponding to the preferred task) became positive over evolutionary time (<xref ref-type="fig" rid="pcbi-1002430-g002">Figure 2A</xref>, bottom panel). As for the incoming connections of the other output neuron (corresponding to the non-preferred task), the direct connection (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e068" xlink:type="simple"/></inline-formula> in the example simulation of <xref ref-type="fig" rid="pcbi-1002430-g002">Figure 2A</xref>) became positive, while the cross-connection (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e069" xlink:type="simple"/></inline-formula>, in <xref ref-type="fig" rid="pcbi-1002430-g002">Figure 2A</xref>) typically became weak, oscillating between positive and negative values. In all simulations, the strongest positive connection was between the stimulus input neuron of the non-preferred task to the output neuron of the preferred task (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e070" xlink:type="simple"/></inline-formula>, in <xref ref-type="fig" rid="pcbi-1002430-g002">Figure 2A</xref>). Hence, individuals use the stimulus for one task (their non-preferred task) to motivate them for performing the other task (their preferred one). As a consequence, they continue performing their preferred task, even if the stimulus level of this task has become very low (<xref ref-type="supplementary-material" rid="pcbi.1002430.s002">Figure S2</xref>). For this parameter combination (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e071" xlink:type="simple"/></inline-formula>½, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e072" xlink:type="simple"/></inline-formula>), the degree of recombination had no effect on the outcome of the simulations (<xref ref-type="supplementary-material" rid="pcbi.1002430.s004">Figure S4A</xref>).</p>
          <p>In the presence of switching costs, the results are considerably different. When switching costs were low (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e073" xlink:type="simple"/></inline-formula>), worker specialization only evolved in the absence of recombination (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e074" xlink:type="simple"/></inline-formula>), with 61.4±7.2% of the colonies (mean ± SD) evolving values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e075" xlink:type="simple"/></inline-formula>0.5. When <italic>c</italic> = 2, worker specialization also evolved in the presence of recombination (<xref ref-type="fig" rid="pcbi-1002430-g002">Figure 2B</xref>). Here 35.6±8.2% of the colonies showed <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e076" xlink:type="simple"/></inline-formula>0.5. In all simulations with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e077" xlink:type="simple"/></inline-formula> there was a clear (but weak) positive relationship between colony fitness and the degree of worker specialization within the colony; colonies with high mean specialization have a fitness advantage of approximately 20% over non-specialized colonies (<xref ref-type="supplementary-material" rid="pcbi.1002430.s003">Figure S3</xref>).</p>
          <p>The bias in favor of one of the tasks that was observed in the absence of switching costs was much less pronounced or even absent in the presence of such costs. For <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e078" xlink:type="simple"/></inline-formula>, initially most colonies show a work distribution close to 1∶1 (<xref ref-type="fig" rid="pcbi-1002430-g002">Figure 2B</xref>, top panel). After about 3500 generations, a new pattern arises, with part of the colonies having a pronounced bias toward task 1, while the other colonies have a bias toward task 2. The simulation shown is representative for higher switching costs (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e079" xlink:type="simple"/></inline-formula>), but to a certain extent the outcome depends on the detailed assumptions. If, for example, recombination was not allowed in the simulation of <xref ref-type="fig" rid="pcbi-1002430-g002">Figure 2B</xref> (i.e., <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e080" xlink:type="simple"/></inline-formula>), three different types of colonies evolved (with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e081" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e082" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e083" xlink:type="simple"/></inline-formula>, respectively; see <xref ref-type="supplementary-material" rid="pcbi.1002430.s011">Text S1</xref> and <xref ref-type="supplementary-material" rid="pcbi.1002430.s004">Figure S4B</xref>).</p>
          <p>The neuronal connection weights linking input neurons to the corresponding output neurons (<italic>i.e.</italic>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e084" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e085" xlink:type="simple"/></inline-formula>) tended to evolve positive values, between 0 and 4 (<xref ref-type="fig" rid="pcbi-1002430-g002">Figure 2B</xref>, bottom panel). One of the cross-connections (<italic>i.e.</italic>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e086" xlink:type="simple"/></inline-formula> or <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e087" xlink:type="simple"/></inline-formula>) showed evolutionary branching <xref ref-type="bibr" rid="pcbi.1002430-Geritz1">[28]</xref>, that is, polymorphism evolved from an initially monomorphic state. <xref ref-type="fig" rid="pcbi-1002430-g002">Figure 2B</xref> is representative in that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e088" xlink:type="simple"/></inline-formula> branches into a bimodal distribution, with one branch becoming negative and the other positive. When such branching occurs, two distinctly different types of networks coexist in the population (<xref ref-type="fig" rid="pcbi-1002430-g003">Figure 3</xref>, top panel). This is crucial for worker specialization: a high degree of specialization only occurred in colonies where the two parents differed in the sign of one of their cross-connection weights. From <xref ref-type="fig" rid="pcbi-1002430-g003">Figure 3</xref> we can deduce how specialization occurs in a colony with dissimilar parents. The key difference between the parents' networks is the genotypic value of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e089" xlink:type="simple"/></inline-formula>, which determines that one parent (arbitrarily labelled ‘male’) is a specialist for task 2, while the ‘female’ shows a large area of the stimulus space where both tasks are activated and where accordingly one of the two tasks is chosen at random (<xref ref-type="fig" rid="pcbi-1002430-g003">Figure 3</xref>, bottom panel). The workers produced by these parents will be divided among those two phenotypes. Stimulus increase initially occurs for both tasks, until the stimuli levels reach a region where individuals with a positive <italic>w</italic><sub>21</sub> will perform task 1. As a consequence, only stimulus 2 will keep increasing, until an area is reached where individuals with a negative <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e090" xlink:type="simple"/></inline-formula> will start performing task 2. The decreasing stimulus of task 2 means that fewer workers will do task 1, because the main motivating force to do task 1 is the positive <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e091" xlink:type="simple"/></inline-formula>. Hence, stimulus for task 1 will also increase. Individuals are then in an area of the stimulus space where half of them will work randomly on either task, while the other half will only perform task 2.</p>
          <fig id="pcbi-1002430-g003" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pcbi.1002430.g003</object-id>
            <label>Figure 3</label>
            <caption>
              <title>Evolved feedforward neural networks of a highly specialized colony.</title>
              <p>In specialized colonies, the networks of the two parents (arbitrarily labelled ‘male’ and ‘female’) differ from each other in a systematic way. Top panels: for each parent, the evolved values of the connection weights and thresholds of the network are shown. Bottom panels: the stimulus-response characteristics of each network type are shown. For each combination of stimuli, the bottom graphs show whether the network is motivated to perform only task 1 (blue), only task 2 (red), both tasks (green; in this case, one task is chosen at random), or none (white). The trajectory of stimulus values from the start to the end of the work phase, in the last generation of the evolutionary simulation, is indicated in black. Starting values were <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e092" xlink:type="simple"/></inline-formula>. Other parameter values as in <xref ref-type="fig" rid="pcbi-1002430-g002">Figure 2B</xref>.</p>
            </caption>
            <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002430.g003" xlink:type="simple"/>
          </fig>
          <p>For <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e093" xlink:type="simple"/></inline-formula>, branching occurred at only one of the cross-connections, while for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e094" xlink:type="simple"/></inline-formula> both cross-connections branched in some of the simulations.</p>
          <p>In the absence of recombination, evolution leads to a higher degree of worker specialization (<xref ref-type="supplementary-material" rid="pcbi.1002430.s004">Figure S4B</xref>). Evolutionary branching occurs now for all the connection weights and for the thresholds as well. The area in stimulus space where networks choose both tasks is much smaller in the absence of recombination (<xref ref-type="supplementary-material" rid="pcbi.1002430.s005">Figure S5</xref>), leading to more pronounced differences between workers and, hence, more specialization. Branching of more loci means that networks will be more differentiated than seen previously for cases with recombination. .</p>
        </sec>
        <sec id="s3a2">
          <title>Optimal worker distribution 3∶1</title>
          <p>In view of eq. (3), when <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e095" xlink:type="simple"/></inline-formula>, the optimal worker distribution over tasks is 3∶1, with task 1 being performed 3 times more often than task 2 (i.e. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e096" xlink:type="simple"/></inline-formula>). Populations indeed evolved a worker distribution approaching this value (<xref ref-type="fig" rid="pcbi-1002430-g004">Figure 4A</xref>, top panel). In absence of switching costs, task 1 was performed 76.7±0.42% of the time (mean ± SD across all replicate populations, for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e097" xlink:type="simple"/></inline-formula>). All colonies attained more than 99% of maximum fitness, with a few colonies achieving the maximum (<xref ref-type="supplementary-material" rid="pcbi.1002430.s003">Figure S3</xref>).</p>
          <fig id="pcbi-1002430-g004" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pcbi.1002430.g004</object-id>
            <label>Figure 4</label>
            <caption>
              <title>Feedforward neural networks: Evolutionary dynamics for two representative simulations, where</title>
              <p><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e098" xlink:type="simple"/></inline-formula> <bold>and</bold> <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e099" xlink:type="simple"/></inline-formula><bold>.</bold> The same graphic conventions as in <xref ref-type="fig" rid="pcbi-1002430-g002">Figure 2</xref> are followed. (A) <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e100" xlink:type="simple"/></inline-formula>. Top graphs: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e101" xlink:type="simple"/></inline-formula> increases to the optimal value 0.75; specialization remains low. Bottom graphs: connection weights incoming at output node 1 become positive (strongest connection weight being <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e102" xlink:type="simple"/></inline-formula>); connection weights incoming at output node 2 become negative (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e103" xlink:type="simple"/></inline-formula>) or positive, but very close to zero (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e104" xlink:type="simple"/></inline-formula>). (B) <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e105" xlink:type="simple"/></inline-formula>. Top graphs:<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e106" xlink:type="simple"/></inline-formula> increases to values above 0.75; <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e107" xlink:type="simple"/></inline-formula> remains low. Bottom graphs: similar to when <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e108" xlink:type="simple"/></inline-formula>, but <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e109" xlink:type="simple"/></inline-formula> is closer to zero.</p>
            </caption>
            <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002430.g004" xlink:type="simple"/>
          </fig>
          <p>A general pattern in the evolution of connection weights was the strengthening of the cross-connection <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e110" xlink:type="simple"/></inline-formula> and the disappearance of connection <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e111" xlink:type="simple"/></inline-formula> (as in <xref ref-type="fig" rid="pcbi-1002430-g004">Figure 4A</xref>, bottom panel). This explains the observed increase in performance of task 1. The cross-connections once more play an important role; since the strongest incentive to do task 1 comes from the stimulus of task 2, this allows workers to keep doing task 1 even if the stimulus for that particular task is depleted.</p>
          <p>Worker specialization did evolve, but only in the absence of recombination (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e112" xlink:type="simple"/></inline-formula>). Even then, specialization levels of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e113" xlink:type="simple"/></inline-formula> were only obtained for a larger number of colonies when switching costs were high (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e114" xlink:type="simple"/></inline-formula>). When worker specialization did not evolve (as in <xref ref-type="fig" rid="pcbi-1002430-g004">Figure 4B</xref>, top panel), colonies evolved work distributions even more biased than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e115" xlink:type="simple"/></inline-formula>. When the work distribution is that strongly biased, the probability to stick to the previous task (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e116" xlink:type="simple"/></inline-formula>) is high even if tasks are taken on at random. Hence, by evolving a work distribution with more than 80% of the work devoted to task 1the number of switches decreases, thus allowing colonies to avoid switching costs even in the absence of worker specialization. In this case, connection <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e117" xlink:type="simple"/></inline-formula> reached lower values than for the simulations without switching costs (<xref ref-type="fig" rid="pcbi-1002430-g004">Figure 4B</xref>, bottom panel).</p>
        </sec>
      </sec>
      <sec id="s3b">
        <title>Recurrent network: self-feedback</title>
        <p>We tested the behavior of a more complex network, where the activation energy of an output neuron could have a feedback on the activation energy at the next time step (<xref ref-type="fig" rid="pcbi-1002430-g001">Figure 1C</xref>). The self-feedback connections were allowed to co-evolve with the rest of the network. We ran ten replicate simulations for all the parameter combinations tested above.</p>
        <sec id="s3b1">
          <title>Optimal worker distribution 1∶1</title>
          <p>In contrast to the results of the feedforward network, the optimal worker distribution <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e118" xlink:type="simple"/></inline-formula> was now realized in a high proportion of colonies (<italic>e.g.</italic>, <xref ref-type="fig" rid="pcbi-1002430-g005">figs. 5AB</xref>). However, this proportion decreased with increasing switching costs. For <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e119" xlink:type="simple"/></inline-formula>, the proportion of colonies with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e120" xlink:type="simple"/></inline-formula> was 99.9±0.3% when <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e121" xlink:type="simple"/></inline-formula> and 100% when <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e122" xlink:type="simple"/></inline-formula>. For <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e123" xlink:type="simple"/></inline-formula>, this proportion was at 76.5±4.1% when <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e124" xlink:type="simple"/></inline-formula> and 46.7±7.6% when <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e125" xlink:type="simple"/></inline-formula> (mean ± SD number of colonies across replicates).</p>
          <fig id="pcbi-1002430-g005" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pcbi.1002430.g005</object-id>
            <label>Figure 5</label>
            <caption>
              <title>Recurrent neural networks: Evolutionary dynamics of the proportion of time spent on task 1,</title>
              <p><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e126" xlink:type="simple"/></inline-formula><bold>, and the degree of worker specialisation,</bold> <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e127" xlink:type="simple"/></inline-formula><bold>.</bold> Two representative simulations are shown for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e128" xlink:type="simple"/></inline-formula>½. (AB) <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e129" xlink:type="simple"/></inline-formula>. In (A), switching costs are absent: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e130" xlink:type="simple"/></inline-formula> quickly reaches the optimal value 0.5; worker specialization does not evolve. In (B), <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e131" xlink:type="simple"/></inline-formula>: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e132" xlink:type="simple"/></inline-formula> becomes more variable, but still approximates the optimal value 0.5; <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e133" xlink:type="simple"/></inline-formula> rapidly increases to its maximal value 1, for all colonies in the population. (CD) <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e134" xlink:type="simple"/></inline-formula>. In (C), switching costs are absent: the evolutionary dynamics is as in (A). In (D), <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e135" xlink:type="simple"/></inline-formula>: not all colonies can evolve worker specialization, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e136" xlink:type="simple"/></inline-formula> is also more variable across colonies.</p>
            </caption>
            <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002430.g005" xlink:type="simple"/>
          </fig>
          <p>When <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e137" xlink:type="simple"/></inline-formula>, all colonies in all replicate simulations achieved the maximum possible fitness, indicating that all workers are active all the time (<xref ref-type="supplementary-material" rid="pcbi.1002430.s006">Figure S6</xref>). Workers switched randomly between tasks (<italic>D</italic> = 0 for all colonies, <xref ref-type="fig" rid="pcbi-1002430-g005">Figure 5A</xref>). This was achieved by evolving positive self-feedback connections allowing workers to continue working even in the absence of an external stimulus for a task. Connection weights from stimuli input neurons to output neurons were also positive (<xref ref-type="supplementary-material" rid="pcbi.1002430.s007">Figure S7</xref>).</p>
          <p>Worker specialization evolved already for low switching costs (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e138" xlink:type="simple"/></inline-formula>), but the behavior shown by colonies, for all <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e139" xlink:type="simple"/></inline-formula>, differs considerably in the simulations in the presence or absence of recombination. In the presence of recombination, all colonies within a population reached a high value of <italic>D</italic> (<xref ref-type="fig" rid="pcbi-1002430-g005">Figure 5B</xref>). In the absence of recombination, populations typically consisted of colonies with low <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e140" xlink:type="simple"/></inline-formula> and colonies with high <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e141" xlink:type="simple"/></inline-formula> (<xref ref-type="fig" rid="pcbi-1002430-g005">Figure 5D</xref>). For <italic>c</italic> = 1, for example, 25±7% of the colonies (mean ± SD across replicates) had <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e142" xlink:type="simple"/></inline-formula>, while 66±7% of colonies showed <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e143" xlink:type="simple"/></inline-formula>.</p>
          <p>In the simulations where all colonies exhibited a high level of worker specialization, self-feedback connections evolved very high positive values (as in <xref ref-type="fig" rid="pcbi-1002430-g006">Figure 6</xref>, top panel). The connection weights from task stimulus to corresponding output neuron (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e144" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e145" xlink:type="simple"/></inline-formula>) evolved to positive values, while cross-connection weights (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e146" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e147" xlink:type="simple"/></inline-formula>) evolved to negative values (as in <xref ref-type="fig" rid="pcbi-1002430-g006">Figure 6</xref>, bottom panel). In these simulations, the evolved strategy leading to division of labor uses the strong self-feedback connections, accompanied by negative cross-connection weights, to create differentiation between individuals. Since individuals from the beginning perceive different levels of stimuli, differences in activation energy will occur and will be amplified in subsequent time steps, creating consistent differences among individuals. Hence division of labor is achieved by experience-based specialization.</p>
          <fig id="pcbi-1002430-g006" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pcbi.1002430.g006</object-id>
            <label>Figure 6</label>
            <caption>
              <title>Recurrent neural networks: Evolutionary trajectories of network parameters leading to experience-based specialization.</title>
              <p>A simulation is shown in which all colonies in the population evolve high degree of division of labor. Parameter values are: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e148" xlink:type="simple"/></inline-formula>½, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e149" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e150" xlink:type="simple"/></inline-formula>. The self-feedback connection weights, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e151" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e152" xlink:type="simple"/></inline-formula> (third and fourth graph on the top panel), increase over generations, a pattern which is found across simulations showing the same worker specialization patterns. Also representative is the pattern encountered in the other connection weights (bottom panel) is the evolution of negative values in cross-connection weights (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e153" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e154" xlink:type="simple"/></inline-formula>) and positive values in the connection weights between the task stimulus and respective output node (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e155" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e156" xlink:type="simple"/></inline-formula>).</p>
            </caption>
            <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002430.g006" xlink:type="simple"/>
          </fig>
          <p>In the simulations where colonies differ in their degree of worker specialization, neuronal connections (including self-feedback connections) show evolutionary branching, with one branch showing positive values and the other branch negative values or values close to zero (<xref ref-type="fig" rid="pcbi-1002430-g007">Figure 7</xref>). In this case, evolutionary branching allows for the co-existence of different genetically determined specialists, as seen previously for the simpler feedforward architecture.</p>
          <fig id="pcbi-1002430-g007" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pcbi.1002430.g007</object-id>
            <label>Figure 7</label>
            <caption>
              <title>Recurrent neural networks: Evolutionary trajectories of network parameters leading to genetically-determined specialization.</title>
              <p>A simulation is shown in which only half of the colonies in the population evolve a high degree of specialization. Parameter values as in <xref ref-type="fig" rid="pcbi-1002430-g006">figure 6</xref>. All connection weights undergo evolutionary branching. The self-feedback (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e157" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e158" xlink:type="simple"/></inline-formula>) and crossed connection weights (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e159" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e160" xlink:type="simple"/></inline-formula>) show one branch with negative values and the other with positive values. The other connection weights show one branch close to zero and the other larger, positive values.</p>
            </caption>
            <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002430.g007" xlink:type="simple"/>
          </fig>
        </sec>
        <sec id="s3b2">
          <title>Optimal worker distribution 3∶1</title>
          <p>In the absence of switching costs, the mean <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e161" xlink:type="simple"/></inline-formula> calculated across replicates was 0.75 and, hence, corresponding to the optimal value for fitness (<xref ref-type="fig" rid="pcbi-1002430-g008">Figure 8A</xref>). Interestingly, worker specialization was negative (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e162" xlink:type="simple"/></inline-formula>) in all colonies in 19 out of 20 simulations (encompassing both simulations where recombination is present as well as where it is absent). In other words, individuals switched more often between tasks than expected by chance.</p>
          <fig id="pcbi-1002430-g008" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pcbi.1002430.g008</object-id>
            <label>Figure 8</label>
            <caption>
              <title>Recurrent neural networks: Evolutionary dynamics of work distribution</title>
              <p><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e163" xlink:type="simple"/></inline-formula> <bold>and worker specialisation</bold> <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e164" xlink:type="simple"/></inline-formula> <bold>for</bold> <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e165" xlink:type="simple"/></inline-formula> <bold>and</bold> <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e166" xlink:type="simple"/></inline-formula><bold>.</bold> (A) <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e167" xlink:type="simple"/></inline-formula>. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e168" xlink:type="simple"/></inline-formula> quickly reaches the optimal value 0.75. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e169" xlink:type="simple"/></inline-formula> evolves to negative values, indicating that individuals switch tasks more often than by chance. (B) <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e170" xlink:type="simple"/></inline-formula>. <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e171" xlink:type="simple"/></inline-formula> increases to values above 0.75; worker specialization does not evolve.</p>
            </caption>
            <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002430.g008" xlink:type="simple"/>
          </fig>
          <p>Worker specialization never evolved for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e172" xlink:type="simple"/></inline-formula>. For <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e173" xlink:type="simple"/></inline-formula>, specialization only evolved in the absence of recombination. These results are shown in the Supplementary Material (<xref ref-type="supplementary-material" rid="pcbi.1002430.s012">Text S2</xref>, <xref ref-type="supplementary-material" rid="pcbi.1002430.s008">Figures S8</xref>, <xref ref-type="supplementary-material" rid="pcbi.1002430.s009">S9</xref>, <xref ref-type="supplementary-material" rid="pcbi.1002430.s010">S10</xref>). For <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e174" xlink:type="simple"/></inline-formula>, in two of the replicates, all colonies show high levels of specialization, accompanied by the optimal worker distribution (<xref ref-type="supplementary-material" rid="pcbi.1002430.s008">Figure S8A</xref>). In these particular replicates the self-feedback connections became strongly positive (<xref ref-type="supplementary-material" rid="pcbi.1002430.s009">Figure S9</xref>). In all other replicates only about half the colonies showed <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e175" xlink:type="simple"/></inline-formula>, while the other half had no specialization (<xref ref-type="supplementary-material" rid="pcbi.1002430.s008">Figure S8B</xref>). The distribution of workers over tasks was highly variable, with very few colonies actually achieving <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e176" xlink:type="simple"/></inline-formula>. The networks in these populations showed evolutionary branching of self-feedback connections (<xref ref-type="supplementary-material" rid="pcbi.1002430.s010">Figure S10</xref>).</p>
          <p>For higher switching costs (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e177" xlink:type="simple"/></inline-formula>), worker specialization could evolve in the presence of recombination, but only in three replicates out of 20, in the evolutionary time considered (results not shown). In these replicates, all colonies combined high levels of specialization and a work distribution very close to the optimal value of 0.75. Worker specialization was again achieved through two different types of networks; one where evolutionary branching occurs in key neuronal connections (particularly self-feedback connections), and the other through evolution of strong positive self-feedback connections (not shown). The first network type leads to a population where only half the colonies have specialized workers, and the correct work proportion is hardly achieved; the second network type leads to a population where all colonies have a high level of specialization and the optimal work proportion.</p>
        </sec>
      </sec>
    </sec>
    <sec id="s4">
      <title>Discussion</title>
      <p>Here we studied whether and how two different neural network architectures enable the evolution of self-organized division of labor and adaptive task ratios. Our results are summarized in <xref ref-type="table" rid="pcbi-1002430-t001">table 1</xref>.</p>
      <table-wrap id="pcbi-1002430-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1002430.t001</object-id><label>Table 1</label><caption>
          <title>Work proportion and degree of division of labor obtained under different behavioral architectures.</title>
        </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1002430-t001-1" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002430.t001" xlink:type="simple"/><table>
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <td align="left" colspan="1" rowspan="1"/>
              <td align="left" colspan="1" rowspan="1"/>
              <td align="left" colspan="3" rowspan="1"><italic>r</italic> = 0</td>
              <td align="left" colspan="3" rowspan="1"><italic>r</italic> = 0.5</td>
              <td align="left" colspan="1" rowspan="1"/>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">Work ratio</td>
              <td align="left" colspan="1" rowspan="1">Result</td>
              <td align="left" colspan="1" rowspan="1"><italic>c</italic> = 0</td>
              <td align="left" colspan="1" rowspan="1"><italic>c</italic> = 1</td>
              <td align="left" colspan="1" rowspan="1"><italic>c</italic>≥2</td>
              <td align="left" colspan="1" rowspan="1"><italic>c</italic> = 0</td>
              <td align="left" colspan="1" rowspan="1"><italic>c</italic> = 1</td>
              <td align="left" colspan="1" rowspan="1"><italic>c</italic>≥2</td>
              <td align="left" colspan="1" rowspan="1">Model</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" colspan="1" rowspan="1">
                <bold>
                  <italic>β</italic>
                </bold>
                <bold> = 0.5</bold>
              </td>
              <td align="left" colspan="1" rowspan="1">
                <bold>
                  <italic>p</italic>
                </bold>
                <bold><sub>1</sub> = </bold>
                <bold>
                  <italic>β</italic>
                </bold>
              </td>
              <td align="left" colspan="1" rowspan="1">Y</td>
              <td align="left" colspan="1" rowspan="1">Y</td>
              <td align="left" colspan="1" rowspan="1">Y</td>
              <td align="left" colspan="1" rowspan="1">Y</td>
              <td align="left" colspan="1" rowspan="1">Y</td>
              <td align="left" colspan="1" rowspan="1">Y</td>
              <td align="left" colspan="1" rowspan="1">RT</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1"/>
              <td align="left" colspan="1" rowspan="1"/>
              <td align="left" colspan="1" rowspan="1">N</td>
              <td align="left" colspan="1" rowspan="1">P</td>
              <td align="left" colspan="1" rowspan="1">P</td>
              <td align="left" colspan="1" rowspan="1">N</td>
              <td align="left" colspan="1" rowspan="1">N</td>
              <td align="left" colspan="1" rowspan="1">P</td>
              <td align="left" colspan="1" rowspan="1">FFN</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1"/>
              <td align="left" colspan="1" rowspan="1"/>
              <td align="left" colspan="1" rowspan="1">Y</td>
              <td align="left" colspan="1" rowspan="1">P</td>
              <td align="left" colspan="1" rowspan="1">P</td>
              <td align="left" colspan="1" rowspan="1">Y</td>
              <td align="left" colspan="1" rowspan="1">Y</td>
              <td align="left" colspan="1" rowspan="1">P</td>
              <td align="left" colspan="1" rowspan="1">RN</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1"/>
              <td align="left" colspan="1" rowspan="1">
                <bold>
                  <italic>D</italic>
                </bold>
                <bold>&gt;0.5</bold>
              </td>
              <td align="left" colspan="1" rowspan="1">N</td>
              <td align="left" colspan="1" rowspan="1">P</td>
              <td align="left" colspan="1" rowspan="1">P</td>
              <td align="left" colspan="1" rowspan="1">N</td>
              <td align="left" colspan="1" rowspan="1">N</td>
              <td align="left" colspan="1" rowspan="1">P</td>
              <td align="left" colspan="1" rowspan="1">RT</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1"/>
              <td align="left" colspan="1" rowspan="1"/>
              <td align="left" colspan="1" rowspan="1">N</td>
              <td align="left" colspan="1" rowspan="1">P</td>
              <td align="left" colspan="1" rowspan="1">P</td>
              <td align="left" colspan="1" rowspan="1">N</td>
              <td align="left" colspan="1" rowspan="1">N</td>
              <td align="left" colspan="1" rowspan="1">P</td>
              <td align="left" colspan="1" rowspan="1">FFN</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1"/>
              <td align="left" colspan="1" rowspan="1"/>
              <td align="left" colspan="1" rowspan="1">N</td>
              <td align="left" colspan="1" rowspan="1">P</td>
              <td align="left" colspan="1" rowspan="1">P<xref ref-type="table-fn" rid="nt101">1</xref></td>
              <td align="left" colspan="1" rowspan="1">N</td>
              <td align="left" colspan="1" rowspan="1">Y</td>
              <td align="left" colspan="1" rowspan="1">Y</td>
              <td align="left" colspan="1" rowspan="1">RN</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1">
                <bold>
                  <italic>β</italic>
                </bold>
                <bold> = 0.75</bold>
              </td>
              <td align="left" colspan="1" rowspan="1">
                <bold>
                  <italic>p</italic>
                </bold>
                <bold><sub>1</sub> = </bold>
                <bold>
                  <italic>β</italic>
                </bold>
              </td>
              <td align="left" colspan="1" rowspan="1">N</td>
              <td align="left" colspan="1" rowspan="1">N</td>
              <td align="left" colspan="1" rowspan="1">N</td>
              <td align="left" colspan="1" rowspan="1">N</td>
              <td align="left" colspan="1" rowspan="1">N</td>
              <td align="left" colspan="1" rowspan="1">N</td>
              <td align="left" colspan="1" rowspan="1">RT</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1"/>
              <td align="left" colspan="1" rowspan="1"/>
              <td align="left" colspan="1" rowspan="1">Y</td>
              <td align="left" colspan="1" rowspan="1">P</td>
              <td align="left" colspan="1" rowspan="1">N</td>
              <td align="left" colspan="1" rowspan="1">Y</td>
              <td align="left" colspan="1" rowspan="1">P</td>
              <td align="left" colspan="1" rowspan="1">N<xref ref-type="table-fn" rid="nt102">2</xref></td>
              <td align="left" colspan="1" rowspan="1">FFN</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1"/>
              <td align="left" colspan="1" rowspan="1"/>
              <td align="left" colspan="1" rowspan="1">Y</td>
              <td align="left" colspan="1" rowspan="1">P</td>
              <td align="left" colspan="1" rowspan="1">P<xref ref-type="table-fn" rid="nt103">3</xref></td>
              <td align="left" colspan="1" rowspan="1">Y</td>
              <td align="left" colspan="1" rowspan="1">P</td>
              <td align="left" colspan="1" rowspan="1">N<xref ref-type="table-fn" rid="nt103">3</xref></td>
              <td align="left" colspan="1" rowspan="1">RN</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1"/>
              <td align="left" colspan="1" rowspan="1">
                <bold>
                  <italic>D</italic>
                </bold>
                <bold>&gt;0.5</bold>
              </td>
              <td align="left" colspan="1" rowspan="1">N</td>
              <td align="left" colspan="1" rowspan="1">N</td>
              <td align="left" colspan="1" rowspan="1">P</td>
              <td align="left" colspan="1" rowspan="1">N</td>
              <td align="left" colspan="1" rowspan="1">N</td>
              <td align="left" colspan="1" rowspan="1">P</td>
              <td align="left" colspan="1" rowspan="1">RT</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1"/>
              <td align="left" colspan="1" rowspan="1"/>
              <td align="left" colspan="1" rowspan="1">N</td>
              <td align="left" colspan="1" rowspan="1">N</td>
              <td align="left" colspan="1" rowspan="1">P<xref ref-type="table-fn" rid="nt101">1</xref></td>
              <td align="left" colspan="1" rowspan="1">N</td>
              <td align="left" colspan="1" rowspan="1">N</td>
              <td align="left" colspan="1" rowspan="1">N</td>
              <td align="left" colspan="1" rowspan="1">FFN</td>
            </tr>
            <tr>
              <td align="left" colspan="1" rowspan="1"/>
              <td align="left" colspan="1" rowspan="1"/>
              <td align="left" colspan="1" rowspan="1">N<xref ref-type="table-fn" rid="nt104">4</xref></td>
              <td align="left" colspan="1" rowspan="1">N</td>
              <td align="left" colspan="1" rowspan="1">P<xref ref-type="table-fn" rid="nt103">3</xref></td>
              <td align="left" colspan="1" rowspan="1">N<xref ref-type="table-fn" rid="nt104">4</xref></td>
              <td align="left" colspan="1" rowspan="1">N</td>
              <td align="left" colspan="1" rowspan="1">N<xref ref-type="table-fn" rid="nt103">3</xref></td>
              <td align="left" colspan="1" rowspan="1">RN</td>
            </tr>
          </tbody>
        </table></alternatives><table-wrap-foot>
          <fn id="nt101">
            <label>1</label>
            <p>for <italic>c</italic>≥3.</p>
          </fn>
          <fn id="nt102">
            <label>2</label>
            <p>except small percentage (&lt;3%) when <italic>c</italic> = 2.</p>
          </fn>
          <fn id="nt103">
            <label>3</label>
            <p>with exception of few simulations, where all colonies obtain the result.</p>
          </fn>
          <fn id="nt104">
            <label>4</label>
            <p>D&lt;0.</p>
          </fn>
          <fn id="nt105">
            <label/>
            <p>Overview of results obtained for three different behavioral architectures: RT – response threshold model (A. Duarte, I. Pen, L. Keller and F.J. Weissing, subm.); FFN – feedforward neural network; RNN – recurrent neural network. Parameter combinations are indicated in the first column and first two rows. The second column indicates the result we look for: “<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e178" xlink:type="simple"/></inline-formula>” corresponds to the achievement of the optimal work ratio; “<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e179" xlink:type="simple"/></inline-formula>” corresponds to the evolution of worker specialization. In the central columns, for different levels of switching costs, <italic>c</italic>, we indicate if such results were obtained. “Y” indicates it was satisfied in all replicate simulations; “N” indicates that the result was not obtained, in the majority of simulations; “P” indicates that, in the majority of simulations, a fraction of the colonies within the population obtained the result.</p>
          </fn>
        </table-wrap-foot></table-wrap>
      <p>With a feedforward network (<xref ref-type="table" rid="pcbi-1002430-t001">table 1</xref>), worker specialization evolved more easily (i.e. at lower switching costs) in the absence of recombination. In the absence of recombination the connection weights can co-evolve as a tightly linked block of genes, making it easier to evolve specific combinations of connection weights favoring specialization. Recombination pushes populations into a solution where only one connection weight locus branches, the rest of the network being relatively homogeneous in the population. This allows worker specialization to occur, but to a lesser extent than in the absence of recombination, because at least one of the parent networks in a specialized colony behaves as a generalist for a large range of stimulus combinations. A large percentage of colonies showed no worker specialization, hence, no division of labor. This is because random mating allows for couples with similar genotypes to produce colonies where workers are too similar and therefore division of labor cannot emerge.</p>
      <p>Previous work on the response threshold model (A. Duarte, I. Pen, L. Keller and F. J. Weissing, subm.) showed that the work ratio could not easily deviate from 1∶1, even if a biased work ratio was optimal. In contrast, in the case of the feedforward network, the work ratio was always biased for one of the tasks, even when a symmetric work ratio was optimal (<xref ref-type="table" rid="pcbi-1002430-t001">table 1</xref>). Owing to selection for minimizing idleness, the evolved networks maximized the amount of work done by using the stimulus from one of the tasks to stimulate workers to perform the other task. In this way, one of the tasks was performed in excess (the ‘preferred’ task), even when its associated stimulus had been depleted. Although this may seem counter-intuitive, it represents an advantage over networks that attempt to maximize both tasks, because these networks would be limited to the work strictly necessary to reduce stimuli to zero. When <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e180" xlink:type="simple"/></inline-formula>, the optimal work ratio was achieved, but only in the absence of switching costs. When switching costs were present, the most common evolved strategy was to increase the proportion of work for task 1 in order to minimize switching among tasks.</p>
      <p>Some of the limitations of the simple feedforward network were eliminated in the slightly more complex architecture of the recurrent network, where previous activation energies feed back on current activation energies. Worker specialization evolved at low switching costs, now both in the presence and absence of recombination (<xref ref-type="table" rid="pcbi-1002430-t001">table 1</xref>), at least for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e181" xlink:type="simple"/></inline-formula>. Interestingly, the presence of recombination favored an outcome where all colonies showed a high degree of specialization. In these populations, specialization does not depend on the presence of two complementary networks in the parents of a colony (as in <xref ref-type="fig" rid="pcbi-1002430-g003">figure 3</xref>), but on a strengthening of the self-feedback connections. This allows for initial differences between individuals in stimulus perception to be amplified in subsequent time steps and leads to behavioral differentiation through reinforcement of previous experiences. In the presence of recombination, this strategy prevails. However, when no recombination occurs, evolutionary branching of connection weights is still the prevalent strategy through which worker specialization evolves. Why is the experience-based strategy not observed in all simulations? A likely reason is that to reach this strategy, the values of neural connections must first pass through values where, in the absence of recombination, evolutionary branching is more advantageous. Hence, the evolutionary outcome is dependent on initial conditions. We confirmed this by running simulations where the self-feedback connections were initialized at higher values (e.g., <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e182" xlink:type="simple"/></inline-formula>); in this case all populations evolved the experience-based strategy rather than evolutionary branching (results not shown). The evolution of an experience-based strategy is affected by stochastic effects at the moment that the population passes the “branching point”, namely on the direction and magnitude of genetic variation, that may lead to local fitness optima. The two strategies may thus represent alternative stable states. The mean population fitness of the genetic specialization (evolutionary branching) is noticeably lower than the mean population fitness of the experience-based strategy (<xref ref-type="supplementary-material" rid="pcbi.1002430.s007">Figure S7</xref>).</p>
      <p>The recurrent network also allowed for the optimal work ratio to be reached in most cases, at least by part of the population (<xref ref-type="table" rid="pcbi-1002430-t001">Table 1</xref>), even in the presence of switching costs. When <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e183" xlink:type="simple"/></inline-formula>, the self-feedback connections allow the continuous activation of both tasks, stimulating individuals that had previously done a task to do it again, even in the absence of the corresponding task stimulus. With this architecture it is also harder to attain the optimal work ratio when <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e184" xlink:type="simple"/></inline-formula> and switching costs are considered, and only few replicate populations show both <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e185" xlink:type="simple"/></inline-formula> and high degree of worker specialization.</p>
      <p>The recurrent network has similarities with the reinforced threshold model, in which individual thresholds are lowered after the performance of the respective tasks and increased when the tasks are not performed <xref ref-type="bibr" rid="pcbi.1002430-Theraulaz1">[9]</xref>, <xref ref-type="bibr" rid="pcbi.1002430-Gautrais1">[29]</xref>. In both models, initial differences in experience lead to consistent behavioral differentiation, thus bypassing the need of specific genetic combinations for the emergence of task specialization. However, in terms of the distribution of workers over tasks, the reinforced threshold model suffers from the same limitations as the fixed threshold model, with worker distribution being mainly dependent on the parameters of stimulus dynamics (A. Duarte, T. Janzen, F.J. Weissing and I. Pen, in prep.).</p>
      <p>Our results highlight the importance of considering asymmetries in models of division of labor. In the evolutionary response threshold model by A. Duarte, I. Pen, L. Keller and F. J. Weissing (subm.), we show that a biased <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e186" xlink:type="simple"/></inline-formula>-value cannot be obtained through the evolution of thresholds. To achieve a biased <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e187" xlink:type="simple"/></inline-formula>-value in this model, asymmetry must be present in the environment (e.g. in the values of task-associated stimuli <xref ref-type="bibr" rid="pcbi.1002430-Bonabeau1">[8]</xref>) to which the response-threshold mechanism then responds. However, in reality, asymmetries in the work distribution might also arise from the ability of individuals to perceive and prioritize tasks differently. Here we show that, for both types of networks studied, it is not easy to evolve strict worker specialization together with an asymmetric distribution of workers over tasks. A major difficulty is that in case of genetically determined specialization the work proportion is dependent, to a large extent, on the proportions of different specialists in each colony. Since we only consider single-mated foundresses, colonies in our model show either equal proportions of the two specialist strategies or only one of the specialist strategies. Evolving experience-based specialization enables an asymmetric work distribution and division of labor (although at a lower degree of worker specialization than under symmetric conditions, and only in the absence of recombination), yet the trajectory towards this strategy is subject to stochastic effects that may diverge evolution towards genetically determined specialization or towards an increase of performance of the most needed task beyond its optimal level.</p>
      <p>The observed difficulty in favoring a specific work ratio under switching costs indicates that the simple behavioral architectures investigated are limited in the ability to evolve efficient solutions to complex optimization problems. In the presence of switching costs, it is important for colonies to maximize worker specialization, while at the same time minimizing the number of idle workers <italic>and</italic> optimizing the work ratio. The behavioral architectures considered thus far were only able to evolve sub-optimal solutions to this multi-faceted problem.</p>
      <p>Modelling the evolution of behavioral mechanisms by means of artificial neural networks presents several advantages when compared to <italic>a priori</italic> chosen behavioral architectures such as a response threshold mechanism. First, mechanisms potentially leading to self-organized division of labor are not built into the model, but must emerge from the model. Second, evolving neural networks transcend some limitation of the human mind. When asked to design plausible mechanisms, the imagination of most modellers is limited to simple and intuitive mechanisms (like a response-threshold mechanism) that our mind can easily envisage. For example, it is unlikely that one would envisage a mechanism where a task-associated stimulus does not stimulate the performance of its corresponding task, but of a different one, as it occurs in the feedforward network. By using an independent modelling setup, we can get an idea whether, and to what extent, the results based on the more standard implementations are robust. In our case, the simple feedforward network is too constrained to achieve worker specialization and an appropriate distribution of workers over tasks. By adding a simple elemental feedback the resulting recurrent network had a much higher evolutionary potential. In future models we could consider the evolution of the network's topology, e.g. by allowing the addition and elimination of neurons and connections to an existing network through mutation <xref ref-type="bibr" rid="pcbi.1002430-Yao1">[24]</xref>.</p>
      <p>The simple feed-forward neural network was constrained by a problem already present with the response threshold mechanism: to get specialization at the colony level, the coexistence of two specialist genotypes is necessary. Random mating and recombination played an important role in the evolutionary outcome. In general we observed that recombination made it more difficult for genetic specialization to evolve. With recombination, evolutionary branching at multiple loci occurred only rarely, at very high switching costs. This is in accordance with the argument that, in constant environments, recombination may destroy favorable allelic combinations <xref ref-type="bibr" rid="pcbi.1002430-Otto1">[30]</xref>, <xref ref-type="bibr" rid="pcbi.1002430-Feldman1">[31]</xref>. Our model suggests that in systems where strong genetic task determination and high recombination rates exist, multiple mating would be favored, in order to increase the chance that workers have favorable allelic combinations. This is in accordance to what we observe in honeybees <xref ref-type="bibr" rid="pcbi.1002430-Wilfert1">[32]</xref>, <xref ref-type="bibr" rid="pcbi.1002430-Palmer1">[33]</xref>. Under the recurrent network architecture, recombination may also play a beneficial role by creating more genetic variation in the self-feedback connections, which could favor division of labor emerging through the experience-based strategy.</p>
      <p>The purpose of our approach was not to represent the behavioral architecture of real organisms, but to present a conceptual model that could shed some light on the role of architectural constraints in the evolution of self-organized division of labor. A limitation of this approach is that the larger the network, the more difficult it is to draw conclusions that are biologically relevant. We have implemented two very simple networks, and yet already have six to eight evolvable parameters. We were able to understand the interaction of the networks with the environment and pinpoint the key connections that allowed for specific behaviors, but this may not be possible for more complex architectures.</p>
      <p>The fitness function used (eq. 2) favored the minimization of idleness. Although it is not unrealistic to assume that more work will translate to higher colony productivity, in reality social insect colonies contain a large proportion of idle workers <xref ref-type="bibr" rid="pcbi.1002430-Dornhaus1">[34]</xref>–<xref ref-type="bibr" rid="pcbi.1002430-SchmidHempel1">[36]</xref>. Examples of circumstances that would allow the presence of idle workers include environmental perturbations that require quick recruitment of “stand-by” workers, advantage of energy-saving strategies under poor resource conditions, and selective neutrality of “incompetent” workers due to highly redundant organization of work <xref ref-type="bibr" rid="pcbi.1002430-SchmidHempel1">[36]</xref> (and references therein). As stressed before, here we present a conceptual model for the effect of behavioral architectures in division of labor, and necessarily simplify certain assumptions. A more realistic version of our model would treat fitness as the number of offspring produced by a colony, and explicitly consider the nature of the different tasks (e.g. foraging and brood care).</p>
      <p>Division of labor is a broad topic, with many aspects that were outside the scope of this study. Previous theoretical work has focused on the evolution of differentiated multicellularity, the evolution of germ and soma in multicellular organisms, and the effect of developmental plasticity in gene expression as a cause of individual differentiation <xref ref-type="bibr" rid="pcbi.1002430-Gavrilets1">[37]</xref>–<xref ref-type="bibr" rid="pcbi.1002430-Schlichting1">[40]</xref>. Here we focused on the evolution of behavioral task specialization in groups where reproductive altruism (analogous to germ-soma differentiation) has already evolved, an assumption which is in line with a recent comparative analysis of the evolutionary history of division of labor <xref ref-type="bibr" rid="pcbi.1002430-Simpson1">[41]</xref>. We did not consider the role of developmental plasticity, although this plays an important role in the differentiation of morphological castes <xref ref-type="bibr" rid="pcbi.1002430-Oster2">[42]</xref>. Underlying the different questions concerning division of labor, however, is a problem of functional optimization: Organisms can increase their reproductive success if they perform different tasks efficiently. Dividing tasks among lower-level units within the organism or colony (often referred to as a superorganism) is a solution to the problem. What our model suggests is that the particular behavioral rules through which task specialization arises may impact the evolutionary outcome.</p>
    </sec>
    <sec id="s5">
      <title>Supporting Information</title>
      <supplementary-material id="pcbi.1002430.s001" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002430.s001" xlink:type="simple">
        <label>Figure S1</label>
        <caption>
          <p>Evolutionary trajectories of thresholds for four example simulations differing in the switching costs and the optimal work proportion, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e188" xlink:type="simple"/></inline-formula>. Graphic conventions follow <xref ref-type="fig" rid="pcbi-1002430-g002">figure 2</xref> in main text. In all simulations, <italic>r</italic> = 0.5. (A) <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e189" xlink:type="simple"/></inline-formula>, <italic>c</italic> = 0. (B) <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e190" xlink:type="simple"/></inline-formula>, <italic>c</italic> = 2. (C) <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e191" xlink:type="simple"/></inline-formula>, <italic>c</italic> = 0. (D) <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e192" xlink:type="simple"/></inline-formula>, <italic>c</italic> = 2.</p>
          <p>(TIFF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002430.s002" mimetype="application/postscript" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002430.s002" xlink:type="simple">
        <label>Figure S2</label>
        <caption>
          <p>Typical colony of the last generation of an evolutionary simulation (<italic>c</italic> = 0 and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e193" xlink:type="simple"/></inline-formula>). (A) Number of workers engaged in task 1 (black solid line) and task 2 (grey line) are indicated on the left-hand vertical axis, during time steps of the work phase. Degree of worker specialization, <italic>D</italic> (black dashed line), is indicated on the right-hand vertical axis. From the start, more workers engage in task 2 than task 1. Division Worker specialization close to zero throughout the simulation. (B) Stimulus for task 1 (black line) and task 2 (grey line) during the time steps of the work phase. Stimulus 1 remains at higher values, due to the fewer number of workers performing task 1.</p>
          <p>(EPS)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002430.s003" mimetype="application/postscript" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002430.s003" xlink:type="simple">
        <label>Figure S3</label>
        <caption>
          <p>Relationship between colony fitness and worker specialization at the end of evolutionary simulations of the feedforward network in the absence (AC) and presence (BD) of switching costs. For all colonies, fitness is represented as the fraction of the maximum possible fitness. In (AB), <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e194" xlink:type="simple"/></inline-formula>. (A) <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e195" xlink:type="simple"/></inline-formula>, corresponding to <xref ref-type="fig" rid="pcbi-1002430-g002">fig. 2A</xref> in main text. All colonies achieve a high fitness; despite the fact that the evolved distribution of workers over tasks deviates substantially from the optimum value <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e196" xlink:type="simple"/></inline-formula> (see <xref ref-type="fig" rid="pcbi-1002430-g002">fig. 2</xref> in the main text). As expected in absence of switching costs, there is no relationship between colony fitness and <italic>D</italic>. (B) <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e197" xlink:type="simple"/></inline-formula>, corresponding to <xref ref-type="fig" rid="pcbi-1002430-g002">fig. 2B</xref> in main text. Colony fitness increases with worker specialization, but even for large values of <italic>D</italic> colony fitness is substantially lower than in the absence of switching costs. In (CD), <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e198" xlink:type="simple"/></inline-formula>. (C) <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e199" xlink:type="simple"/></inline-formula>, corresponding to <xref ref-type="fig" rid="pcbi-1002430-g004">fig. 4A</xref> in main text. All colonies achieve the highest possible fitness, because they are now able to achieve the optimal ratio among tasks (3∶1). As expected in absence of switching costs, there is no relation between fitness and <italic>D</italic>. (D) <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e200" xlink:type="simple"/></inline-formula>, corresponding to <xref ref-type="fig" rid="pcbi-1002430-g004">fig. 4B</xref> in main text. Colonies do not reach high <italic>D</italic>, yet fitness changes with <italic>D</italic> in a non-monotonic way.</p>
          <p>(EPS)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002430.s004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002430.s004" xlink:type="simple">
        <label>Figure S4</label>
        <caption>
          <p>Evolutionary dynamics of two representative simulations of the evolution of a feedforward neural network, for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e201" xlink:type="simple"/></inline-formula>½ and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e202" xlink:type="simple"/></inline-formula>. Figure follows graphic conventions of <xref ref-type="fig" rid="pcbi-1002430-g002">fig. 2</xref> in the main text. (A) <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e203" xlink:type="simple"/></inline-formula>. Top graphs: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e204" xlink:type="simple"/></inline-formula> evolves to approximately 0.3. Worker specialization remains at zero. Bottom graphs: connection weights linked to output neuron 2 increase to positive values, the strongest being the cross-connection <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e205" xlink:type="simple"/></inline-formula>. Direct connection weight <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e206" xlink:type="simple"/></inline-formula> becomes positive, while the cross-connection <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e207" xlink:type="simple"/></inline-formula> evolves to negative values. (B) <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e208" xlink:type="simple"/></inline-formula>. Top graphs: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e209" xlink:type="simple"/></inline-formula> becomes more variable, with some colonies achieving the optimal value, 0.5, but most falling in one of two regions, one close to 0.4, the other close to 0.6. <italic>D</italic> rapidly evolves to a bimodal distribution with approximately 70% of the colonies having <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e210" xlink:type="simple"/></inline-formula> and approximately 30% having <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e211" xlink:type="simple"/></inline-formula>. Bottom graphs: all connection weights suffer evolutionary branching. The cross-connections diverge the most, with one branch showing positive values and the other negative values.</p>
          <p>(TIFF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002430.s005" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002430.s005" xlink:type="simple">
        <label>Figure S5</label>
        <caption>
          <p>Evolved feedforward neural networks of the parents of a highly specialized colony in the simulation corresponding to <xref ref-type="supplementary-material" rid="pcbi.1002430.s004">fig. S4B</xref> (last generation). Top panels: evolved values of connection weights and thresholds are shown for each parent. Bottom graphs: the stimulus-response characteristics of each network are shown. For each combination of stimuli, the bottom graphs show whether the network is motivated to perform only task 1 (blue), only task 2 (red), both tasks (green; in this case, a task is chosen at random) or none (white). The black line indicates the trajectory of stimuli values during the work phase of the last generation of the evolutionary simulation. Starting values were <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e212" xlink:type="simple"/></inline-formula>.</p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002430.s006" mimetype="application/postscript" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002430.s006" xlink:type="simple">
        <label>Figure S6</label>
        <caption>
          <p>Relationship between relative fitness and worker specialization, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e213" xlink:type="simple"/></inline-formula>, at the last generation of four representative simulations of the evolution of recurrent neural networks, for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e214" xlink:type="simple"/></inline-formula>. (A) <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e215" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e216" xlink:type="simple"/></inline-formula>: corresponding to <xref ref-type="fig" rid="pcbi-1002430-g005">fig. 5A</xref> in the main text. All colonies reach the highest possible fitness. (B) <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e217" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e218" xlink:type="simple"/></inline-formula>: corresponding to <xref ref-type="fig" rid="pcbi-1002430-g005">fig. 5B</xref> in the main text. All colonies have high degree of worker specialization (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e219" xlink:type="simple"/></inline-formula>). Colonies with the highest level of worker specialization are able to reach also the highest possible fitness. (C) <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e220" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e221" xlink:type="simple"/></inline-formula>: corresponding to <xref ref-type="fig" rid="pcbi-1002430-g006">fig. 6</xref> in main text, one of the few cases in the absence of recombination where all colonies evolve worker specialization, and achieve maximum fitness. (D) Same parameter combination as (C), but depicting the more general pattern found in the absence of recombination and presence of switching costs (corresponding to <xref ref-type="fig" rid="pcbi-1002430-g007">fig. 7</xref> in the main text). Only a portion of the colonies reach high worker specialization, which results in high variation in fitness among colonies.</p>
          <p>(EPS)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002430.s007" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002430.s007" xlink:type="simple">
        <label>Figure S7</label>
        <caption>
          <p>Evolutionary trajectories of thresholds and connection weights of recurrent networks, in a simulation with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e222" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e223" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e224" xlink:type="simple"/></inline-formula>, corresponding to <xref ref-type="fig" rid="pcbi-1002430-g005">Figure 5A</xref> in main text.</p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002430.s008" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002430.s008" xlink:type="simple">
        <label>Figure S8</label>
        <caption>
          <p>Evolutionary dynamics of two simulations of the evolution of a recurrent neural network, with self-feedback, for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e225" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e226" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e227" xlink:type="simple"/></inline-formula>. The simulations are examples of the two strategies that evolved in response to switching costs. (A) The less frequent outcome (2 out of 10 simulations), where all colonies show values of <italic>p</italic><sub>1</sub> close to 0.75, the optimal value, and most colonies show <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e228" xlink:type="simple"/></inline-formula>, at the end of the considered evolutionary time. (B) The more frequent outcome, where approximately half the colonies showed <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e229" xlink:type="simple"/></inline-formula> around 0.5 and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e230" xlink:type="simple"/></inline-formula>, and the other half showed <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e231" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e232" xlink:type="simple"/></inline-formula>.</p>
          <p>(TIFF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002430.s009" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002430.s009" xlink:type="simple">
        <label>Figure S9</label>
        <caption>
          <p>Evolutionary trajectories of thresholds and connection weights of recurrent networks, in a simulation with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e233" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e234" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e235" xlink:type="simple"/></inline-formula>, corresponding to <xref ref-type="supplementary-material" rid="pcbi.1002430.s007">fig. S7A</xref>. Top graphs: self-feedback connection weights evolve positive values, as in other simulations where all colonies showed high degree of worker specialization. Evolution of thresholds did not show a specific pattern across simulations, hence it plays a less important role in the outcome. Weights showed positive values for direct connections (with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e236" xlink:type="simple"/></inline-formula>) and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e237" xlink:type="simple"/></inline-formula>) and negative values for cross-connections (with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e238" xlink:type="simple"/></inline-formula>), a pattern also representative for other simulations where all colonies evolved worker specialization.</p>
          <p>(TIFF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002430.s010" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002430.s010" xlink:type="simple">
        <label>Figure S10</label>
        <caption>
          <p>Evolutionary trajectories of thresholds and connection weights of recurrent networks, in a simulation with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e239" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e240" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002430.e241" xlink:type="simple"/></inline-formula>, corresponding to <xref ref-type="supplementary-material" rid="pcbi.1002430.s007">fig. S7B</xref>. Top graphs: Self-feedback connection weights go through evolutionary branching, as in other simulations where only a portion of the colonies shows high degree of worker specialization. One branch has positive values, and the other negative values. Bottom graphs: weights are maintained at quite low values, oscillating around zero.</p>
          <p>(TIFF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002430.s011" mimetype="application/msword" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002430.s011" xlink:type="simple">
        <label>Text S1</label>
        <caption>
          <p>Feedforward neural network.</p>
          <p>(DOC)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002430.s012" mimetype="application/msword" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002430.s012" xlink:type="simple">
        <label>Text S2</label>
        <caption>
          <p>Recurrent neural networks, with self-feedback.</p>
          <p>(DOC)</p>
        </caption>
      </supplementary-material>
    </sec>
  </body>
  <back>
    <ack>
      <p>The authors would like to thank Ido Pen, Laurent Keller, Steffen Wischmann and Alex Ivanov for fruitful discussions and advice, and two anonymous reviewers for comments which greatly improved the manuscript.</p>
    </ack>
    <ref-list>
      <title>References</title>
      <ref id="pcbi.1002430-Szathmry1">
        <label>1</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Szathmáry</surname><given-names>E</given-names></name><name name-style="western"><surname>Maynard Smith</surname><given-names>J</given-names></name></person-group>             <year>1995</year>             <article-title>The major evolutionary transitions.</article-title>             <source>Nature</source>             <volume>374</volume>             <fpage>227</fpage>             <lpage>232</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002430-Oster1">
        <label>2</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Oster</surname><given-names>GF</given-names></name><name name-style="western"><surname>Wilson</surname><given-names>EO</given-names></name></person-group>             <year>1978</year>             <source>Caste and ecology in the social insects</source>             <publisher-loc>Princeton</publisher-loc>             <publisher-name>Princeton University Press</publisher-name>          </element-citation>
      </ref>
      <ref id="pcbi.1002430-Boomsma1">
        <label>3</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Boomsma</surname><given-names>JJ</given-names></name></person-group>             <year>2007</year>             <article-title>Kin selection versus sexual selection: Why the ends do not meet.</article-title>             <source>Curr Biol</source>             <volume>17</volume>             <fpage>R673</fpage>             <lpage>R683</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002430-Boomsma2">
        <label>4</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Boomsma</surname><given-names>JJ</given-names></name><name name-style="western"><surname>Beekman</surname><given-names>M</given-names></name><name name-style="western"><surname>Cornwallis</surname><given-names>CK</given-names></name><name name-style="western"><surname>Griffin</surname><given-names>AS</given-names></name><name name-style="western"><surname>Holman</surname><given-names>L</given-names></name><etal/></person-group>             <year>2011</year>             <article-title>Only full-sibling families evolved eusociality.</article-title>             <source>Nature</source>             <volume>471</volume>             <fpage>E4</fpage>             <lpage>E5</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002430-Fewell1">
        <label>5</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Fewell</surname><given-names>JH</given-names></name><name name-style="western"><surname>Page</surname><given-names>RE</given-names></name></person-group>             <year>1999</year>             <article-title>The emergence of division of labour in forced associations of normally solitary ant queens.</article-title>             <source>Evol Ecol Res</source>             <volume>1</volume>             <fpage>537</fpage>             <lpage>548</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002430-Jeanson1">
        <label>6</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Jeanson</surname><given-names>R</given-names></name><name name-style="western"><surname>Clark</surname><given-names>RM</given-names></name><name name-style="western"><surname>Holbrook</surname><given-names>CT</given-names></name><name name-style="western"><surname>Bertram</surname><given-names>SM</given-names></name><name name-style="western"><surname>Fewell</surname><given-names>JH</given-names></name><etal/></person-group>             <year>2008</year>             <article-title>Division of labour and socially induced changes in response thresholds in associations of solitary halictine bees.</article-title>             <source>Anim Behav</source>             <volume>76</volume>             <fpage>593</fpage>             <lpage>602</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002430-Duarte1">
        <label>7</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Duarte</surname><given-names>A</given-names></name><name name-style="western"><surname>Weissing</surname><given-names>FJ</given-names></name><name name-style="western"><surname>Pen</surname><given-names>I</given-names></name><name name-style="western"><surname>Keller</surname><given-names>L</given-names></name></person-group>             <year>2011</year>             <article-title>An evolutionary perspective on self-organized division of labor in social insects.</article-title>             <source>Annu Rev Ecol Evol Syst</source>             <volume>42</volume>             <fpage>91</fpage>             <lpage>110</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002430-Bonabeau1">
        <label>8</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Bonabeau</surname><given-names>E</given-names></name><name name-style="western"><surname>Theraulaz</surname><given-names>G</given-names></name><name name-style="western"><surname>Deneubourg</surname><given-names>JL</given-names></name></person-group>             <year>1996</year>             <article-title>Quantitative study of the fixed threshold model for the regulation of division of labour in insect societies.</article-title>             <source>Proc R Soc B</source>             <volume>263</volume>             <fpage>1565</fpage>             <lpage>1569</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002430-Theraulaz1">
        <label>9</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Theraulaz</surname><given-names>G</given-names></name><name name-style="western"><surname>Bonabeau</surname><given-names>E</given-names></name><name name-style="western"><surname>Deneubourg</surname><given-names>JL</given-names></name></person-group>             <year>1998</year>             <article-title>Response threshold reinforcement and division of labour in insect societies.</article-title>             <source>Proc R Soc B</source>             <volume>265</volume>             <fpage>327</fpage>             <lpage>332</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002430-Page1">
        <label>10</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Page</surname><given-names>RE</given-names></name><name name-style="western"><surname>Mitchell</surname><given-names>SD</given-names></name></person-group>             <year>1998</year>             <article-title>Self-organization and the evolution of division of labor.</article-title>             <source>Apidologie</source>             <volume>29</volume>             <fpage>171</fpage>             <lpage>190</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002430-Franks1">
        <label>11</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Franks</surname><given-names>NR</given-names></name><name name-style="western"><surname>Tofts</surname><given-names>C</given-names></name></person-group>             <year>1994</year>             <article-title>Foraging for work - how tasks allocate workers.</article-title>             <source>Anim Behav</source>             <volume>48</volume>             <fpage>470</fpage>             <lpage>472</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002430-Johnson1">
        <label>12</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Johnson</surname><given-names>BR</given-names></name></person-group>             <year>2009</year>             <article-title>A Self-Organizing Model for Task Allocation via Frequent Task Quitting and Random Walks in the Honeybee.</article-title>             <source>Am Nat</source>             <volume>174</volume>             <fpage>537</fpage>             <lpage>547</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002430-Bonabeau2">
        <label>13</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Bonabeau</surname><given-names>E</given-names></name><name name-style="western"><surname>Theraulaz</surname><given-names>G</given-names></name><name name-style="western"><surname>Deneubourg</surname><given-names>JL</given-names></name><name name-style="western"><surname>Aron</surname><given-names>S</given-names></name><name name-style="western"><surname>Camazine</surname><given-names>S</given-names></name></person-group>             <year>1997</year>             <article-title>Self-organization in social insects.</article-title>             <source>Trends Ecol Evol</source>             <volume>12</volume>             <fpage>188</fpage>             <lpage>193</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002430-Tarapore1">
        <label>14</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Tarapore</surname><given-names>D</given-names></name><name name-style="western"><surname>Floreano</surname><given-names>D</given-names></name><name name-style="western"><surname>Keller</surname><given-names>L</given-names></name></person-group>             <year>2009</year>             <article-title>Task dependent influence of genetic architecture and mating frequency on division of labour in social insect societies.</article-title>             <source>Behav Ecol Sociobiol</source>             <volume>64</volume>             <fpage>675</fpage>             <lpage>684</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002430-Waibel1">
        <label>15</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Waibel</surname><given-names>M</given-names></name><name name-style="western"><surname>Floreano</surname><given-names>D</given-names></name><name name-style="western"><surname>Magnenat</surname><given-names>S</given-names></name><name name-style="western"><surname>Keller</surname><given-names>L</given-names></name></person-group>             <year>2006</year>             <article-title>Division of labour and colony efficiency in social insects: effects of interactions between genetic architecture, colony kin structure and rate of perturbations.</article-title>             <source>Proc R Soc B</source>             <volume>273</volume>             <fpage>1815</fpage>             <lpage>1823</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002430-Tannenbaum1">
        <label>16</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Tannenbaum</surname><given-names>E</given-names></name></person-group>             <year>2007</year>             <article-title>When does division of labor lead to increased system output?</article-title>             <source>J Theor Biol</source>             <volume>247</volume>             <fpage>413</fpage>             <lpage>425</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002430-Wahl1">
        <label>17</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Wahl</surname><given-names>LM</given-names></name></person-group>             <year>2002</year>             <article-title>Evolving the division of labour: Generalists, specialists and task allocation.</article-title>             <source>J Theor Biol</source>             <volume>219</volume>             <fpage>371</fpage>             <lpage>388</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002430-Ghirlanda1">
        <label>18</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ghirlanda</surname><given-names>S</given-names></name><name name-style="western"><surname>Enquist</surname><given-names>M</given-names></name></person-group>             <year>1998</year>             <article-title>Artificial neural networks as models of stimulus control.</article-title>             <source>Anim Behav</source>             <volume>56</volume>             <fpage>1383</fpage>             <lpage>1389</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002430-Haykin1">
        <label>19</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Haykin</surname><given-names>S</given-names></name></person-group>             <year>1999</year>             <source>Neural networks: A comprehensive foundation</source>             <publisher-name>Pearson Education, Inc</publisher-name>          </element-citation>
      </ref>
      <ref id="pcbi.1002430-Floreano1">
        <label>20</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Floreano</surname><given-names>D</given-names></name><name name-style="western"><surname>Mitri</surname><given-names>S</given-names></name><name name-style="western"><surname>Magnenat</surname><given-names>S</given-names></name><name name-style="western"><surname>Keller</surname><given-names>L</given-names></name></person-group>             <year>2007</year>             <article-title>Evolutionary conditions for the emergence of communication in robots.</article-title>             <source>Curr Biol</source>             <volume>17</volume>             <fpage>514</fpage>             <lpage>519</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002430-Mitri1">
        <label>21</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Mitri</surname><given-names>S</given-names></name><name name-style="western"><surname>Floreano</surname><given-names>D</given-names></name><name name-style="western"><surname>Keller</surname><given-names>L</given-names></name></person-group>             <year>2009</year>             <article-title>The evolution of information suppression in communicating robots with conflicting interests.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>106</volume>             <fpage>15786</fpage>             <lpage>15790</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002430-Mitri2">
        <label>22</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Mitri</surname><given-names>S</given-names></name><name name-style="western"><surname>Floreano</surname><given-names>D</given-names></name><name name-style="western"><surname>Keller</surname><given-names>L</given-names></name></person-group>             <year>2011</year>             <article-title>Relatedness influences signal reliability in evolving robots.</article-title>             <source>Proc R Soc B</source>             <volume>278</volume>             <fpage>378</fpage>             <lpage>383</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002430-Lichocki1">
        <label>23</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Lichocki</surname><given-names>P</given-names></name><name name-style="western"><surname>Tarapore</surname><given-names>D</given-names></name><name name-style="western"><surname>Keller</surname><given-names>L</given-names></name><name name-style="western"><surname>Floreano</surname><given-names>D</given-names></name></person-group>             <year>2012</year>             <article-title>Neural Networks as Mechanisms to Regulate Division of Labor.</article-title>             <source>Am Nat</source>             <comment>(in press). doi:10.1086/664079</comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002430-Yao1">
        <label>24</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Yao</surname><given-names>X</given-names></name></person-group>             <year>1999</year>             <article-title>Evolving artificial neural networks.</article-title>             <source>P Ieee</source>             <volume>87</volume>             <fpage>1423</fpage>             <lpage>1447</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002430-Fogel1">
        <label>25</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Fogel</surname><given-names>DB</given-names></name><name name-style="western"><surname>Fogel</surname><given-names>LJ</given-names></name><name name-style="western"><surname>Porto</surname><given-names>VW</given-names></name></person-group>             <year>1990</year>             <article-title>Evolving neural networks.</article-title>             <source>Biol Cybern</source>             <volume>63</volume>             <fpage>487</fpage>             <lpage>493</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002430-Ravary1">
        <label>26</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ravary</surname><given-names>F</given-names></name><name name-style="western"><surname>Lecoutey</surname><given-names>E</given-names></name><name name-style="western"><surname>Kaminski</surname><given-names>G</given-names></name><name name-style="western"><surname>Chaline</surname><given-names>N</given-names></name><name name-style="western"><surname>Jaisson</surname><given-names>P</given-names></name></person-group>             <year>2007</year>             <article-title>Individual experience alone can generate lasting division of labor in ants.</article-title>             <source>Curr Biol</source>             <volume>17</volume>             <fpage>1308</fpage>             <lpage>1312</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002430-Smith1">
        <label>27</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Smith</surname><given-names>A</given-names></name></person-group>             <year>1776</year>             <source>An inquiry into the nature and causes of the wealth of nations</source>             <publisher-loc>London</publisher-loc>             <publisher-name>W. Strahan and T. Cadell</publisher-name>          </element-citation>
      </ref>
      <ref id="pcbi.1002430-Geritz1">
        <label>28</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Geritz</surname><given-names>SAH</given-names></name><name name-style="western"><surname>Kisdi</surname><given-names>E</given-names></name><name name-style="western"><surname>Meszena</surname><given-names>G</given-names></name><name name-style="western"><surname>Metz</surname><given-names>JAJ</given-names></name></person-group>             <year>1998</year>             <article-title>Evolutionarily singular strategies and the adaptive growth and branching of the evolutionary tree.</article-title>             <source>Evol Ecol</source>             <volume>12</volume>             <fpage>35</fpage>             <lpage>57</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002430-Gautrais1">
        <label>29</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Gautrais</surname><given-names>J</given-names></name><name name-style="western"><surname>Theraulaz</surname><given-names>G</given-names></name><name name-style="western"><surname>Deneubourg</surname><given-names>JL</given-names></name><name name-style="western"><surname>Anderson</surname><given-names>C</given-names></name></person-group>             <year>2002</year>             <article-title>Emergent polyethism as a consequence of increased colony size in insect societies.</article-title>             <source>J Theor Biol</source>             <volume>215</volume>             <fpage>363</fpage>             <lpage>373</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002430-Otto1">
        <label>30</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Otto</surname><given-names>SP</given-names></name><name name-style="western"><surname>Michalakis</surname><given-names>Y</given-names></name></person-group>             <year>1998</year>             <article-title>The evolution of recombination in changing environments.</article-title>             <source>Trends Ecol Evol</source>             <volume>13</volume>             <fpage>145</fpage>             <lpage>151</lpage>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0169-5347(97)01260-3" xlink:type="simple">10.1016/S0169-5347(97)01260-3</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002430-Feldman1">
        <label>31</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Feldman</surname><given-names>MW</given-names></name><name name-style="western"><surname>Otto</surname><given-names>SP</given-names></name><name name-style="western"><surname>Christiansen</surname><given-names>FB</given-names></name></person-group>             <year>1996</year>             <article-title>Population genetic perspectives on the evolution of recombination.</article-title>             <source>Annu Rev Gen</source>             <volume>30</volume>             <fpage>261</fpage>             <lpage>295</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002430-Wilfert1">
        <label>32</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Wilfert</surname><given-names>L</given-names></name><name name-style="western"><surname>Gadau</surname><given-names>J</given-names></name><name name-style="western"><surname>Schmid-Hempel</surname><given-names>P</given-names></name></person-group>             <year>2007</year>             <article-title>Variation in genomic recombination rates among animal taxa and the case of social insects.</article-title>             <source>Heredity</source>             <volume>98</volume>             <fpage>189</fpage>             <lpage>197</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002430-Palmer1">
        <label>33</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Palmer</surname><given-names>KA</given-names></name><name name-style="western"><surname>Oldroyd</surname><given-names>BP</given-names></name></person-group>             <year>2000</year>             <article-title>Evolution of multiple mating in the genus.</article-title>             <source>Apis Apidologie</source>             <volume>31</volume>             <fpage>235</fpage>             <lpage>248</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002430-Dornhaus1">
        <label>34</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Dornhaus</surname><given-names>A</given-names></name><name name-style="western"><surname>Holley</surname><given-names>JA</given-names></name><name name-style="western"><surname>Pook</surname><given-names>VG</given-names></name><name name-style="western"><surname>Worswick</surname><given-names>G</given-names></name><name name-style="western"><surname>Franks</surname><given-names>NR</given-names></name></person-group>             <year>2008</year>             <article-title>Why do not all workers work? Colony size and workload during emigrations in the ant Temnothorax albipennis.</article-title>             <source>Behav Ecol Sociobiol</source>             <volume>63</volume>             <fpage>43</fpage>             <lpage>51</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002430-Thomas1">
        <label>35</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Thomas</surname><given-names>ML</given-names></name><name name-style="western"><surname>Elgar</surname><given-names>MA</given-names></name></person-group>             <year>2003</year>             <article-title>Colony size affects division of labour in the ponerine ant.</article-title>             <source>Rhytidoponera metallica Naturwissenschaften</source>             <volume>90</volume>             <fpage>88</fpage>             <lpage>92</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002430-SchmidHempel1">
        <label>36</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Schmid-Hempel</surname><given-names>P</given-names></name></person-group>             <year>1990</year>             <article-title>Reproductive competition and the evolution of work load in social insects.</article-title>             <source>Am Nat</source>             <volume>135</volume>             <fpage>501</fpage>             <lpage>526</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002430-Gavrilets1">
        <label>37</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Gavrilets</surname><given-names>S</given-names></name></person-group>             <year>2010</year>             <article-title>Rapid transition towards the division of labor via evolution of developmental plasticity.</article-title>             <source>PLoS Comp Biol</source>             <volume>6</volume>             <fpage>e1000805</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002430-Pfeiffer1">
        <label>38</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Pfeiffer</surname><given-names>T</given-names></name><name name-style="western"><surname>Bonhoeffer</surname><given-names>S</given-names></name></person-group>             <year>2003</year>             <article-title>An evolutionary scenario for the transition to undifferentiated multicellularity.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>100</volume>             <fpage>1095</fpage>             <lpage>1098</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002430-Michod1">
        <label>39</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Michod</surname><given-names>RE</given-names></name></person-group>             <year>2007</year>             <article-title>Evolution of individuality during the transition from unicellular to multicellular life.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>104</volume>             <fpage>8613</fpage>             <lpage>8618</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002430-Schlichting1">
        <label>40</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Schlichting</surname><given-names>CD</given-names></name></person-group>             <year>2003</year>             <article-title>Origins of differentiation via phenotypic plasticity.</article-title>             <source>Evol Dev</source>             <volume>5</volume>             <fpage>98</fpage>             <lpage>105</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002430-Simpson1">
        <label>41</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Simpson</surname><given-names>C</given-names></name></person-group>             <year>2012</year>             <article-title>The evolutionary history of division of labour.</article-title>             <source>P Roy Soc B</source>             <volume>279</volume>             <fpage>116</fpage>             <lpage>121</lpage>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rspb.2011.0766" xlink:type="simple">10.1098/rspb.2011.0766</ext-link></comment>          </element-citation>
      </ref>
      <ref id="pcbi.1002430-Oster2">
        <label>42</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Oster</surname><given-names>GF</given-names></name><name name-style="western"><surname>Wilson</surname><given-names>EO</given-names></name></person-group>             <year>1978</year>             <source>Caste and ecology in the social insects</source>             <publisher-loc>Princeton</publisher-loc>             <publisher-name>Princeton University Press</publisher-name>          </element-citation>
      </ref>
    </ref-list>
    
  </back>
</article>